package com.educative.slidingwindow;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;

public class DNASequances {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		 String x = "AAAAACCCCCAAAAACCCCCCAAAAAGGGTTT";
		 System.out.println(findRepeatedDnaSequences(x));
	}
	
	static List<String> findRepeatedDnaSequences(String s)  {
	    int k=10;
		Set<Integer> set = new HashSet<Integer>();
		Set<String> result = new HashSet<String>();		
		
		for(int i=0;i<s.length()-k+1;i++) {
			String str = s.substring(i, i+k);
			int hashVal = getHash(str);
			if(i>=1) {				
				int out = getHash(""+s.charAt(i-1));				
				hashVal -= out;
				if(hashVal<0) {
					hashVal+=101;
				}
				if(set.contains(hashVal)) {
					result.add(str);					
				}
				else {
					set.add(hashVal);
				}
			}
			else {
				set.add(hashVal);				
			}			
			//System.out.println(str);
		}
		System.out.println(set);	    
	    return new ArrayList<>(result);
    }
	
	static int getHash(String s) {
		int sum=0;
		int base=17;
		int mod = 2003;
		int alp = s.length()-1;
		for(int i=0;i<s.length();i++) {
			int ch = s.charAt(i);
			sum = (int)(sum+ch*Math.pow(base, alp--)%mod);
		}	
		
		return sum;
	}

}
